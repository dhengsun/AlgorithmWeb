"use strict";(self["webpackChunkvue_django_frontend"]=self["webpackChunkvue_django_frontend"]||[]).push([[472],{4472:function(t,e,a){a.r(e),a.d(e,{default:function(){return q}});a(4114);var l=a(6768),s=a(4232);const i={class:"app-container"},n={class:"content-container"},c={class:"quick-actions-container"},o={class:"action-icon"},r={class:"action-icon"},u={class:"action-icon"},d={class:"activity-container"},v={class:"activity-header"},k={class:"heatmap-tabs"},f=["onClick"],h={class:"calendar-container"},g={class:"github-calendar"},b={class:"month-labels"},m={class:"calendar-grid"};function p(t,e,a,p,L,y){const D=(0,l.g2)("app-header"),C=(0,l.g2)("Collection"),_=(0,l.g2)("el-icon"),w=(0,l.g2)("el-card"),F=(0,l.g2)("Reading"),q=(0,l.g2)("Document"),S=(0,l.g2)("el-option"),$=(0,l.g2)("el-select"),T=(0,l.g2)("el-tooltip");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.bF)(D),(0,l.Lk)("div",n,[e[13]||(e[13]=(0,l.Lk)("div",{class:"welcome-container"},[(0,l.Lk)("h1",{class:"welcome-title"},"欢迎使用Erix随写录"),(0,l.Lk)("p",{class:"welcome-subtitle"},"记录你的编程成长轨迹")],-1)),(0,l.Lk)("div",c,[(0,l.bF)(w,{class:"quick-action-card",onClick:e[0]||(e[0]=e=>t.$router.push("/problems"))},{default:(0,l.k6)((()=>[(0,l.Lk)("div",o,[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(C)])),_:1})]),e[4]||(e[4]=(0,l.Lk)("h3",null,"题库",-1)),e[5]||(e[5]=(0,l.Lk)("p",null,"浏览所有题目",-1))])),_:1}),(0,l.bF)(w,{class:"quick-action-card",onClick:e[1]||(e[1]=e=>t.$router.push("/solutions"))},{default:(0,l.k6)((()=>[(0,l.Lk)("div",r,[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(F)])),_:1})]),e[6]||(e[6]=(0,l.Lk)("h3",null,"题解",-1)),e[7]||(e[7]=(0,l.Lk)("p",null,"查看解题思路",-1))])),_:1}),(0,l.bF)(w,{class:"quick-action-card",onClick:e[2]||(e[2]=e=>t.$router.push("/drafts"))},{default:(0,l.k6)((()=>[(0,l.Lk)("div",u,[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(q)])),_:1})]),e[8]||(e[8]=(0,l.Lk)("h3",null,"草稿",-1)),e[9]||(e[9]=(0,l.Lk)("p",null,"临时保存草稿",-1))])),_:1})]),(0,l.Lk)("div",d,[(0,l.bF)(w,{class:"activity-card"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",v,[e[10]||(e[10]=(0,l.Lk)("h2",null,"我的编程日历",-1)),(0,l.bF)($,{modelValue:L.timeRange,"onUpdate:modelValue":e[3]||(e[3]=t=>L.timeRange=t),size:"small",style:{width:"120px"}},{default:(0,l.k6)((()=>[(0,l.bF)(S,{label:"最近半年",value:"half_year"}),(0,l.bF)(S,{label:"最近一年",value:"one_year"}),(0,l.bF)(S,{label:"全部",value:"all"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",k,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(L.heatmapTabs,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id,class:(0,s.C4)(["heatmap-tab",{active:L.activeTab===t.id}]),onClick:e=>L.activeTab=t.id},(0,s.v_)(t.label),11,f)))),128))]),(0,l.Lk)("div",h,[(0,l.Lk)("div",g,[(0,l.Lk)("div",b,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(y.monthLabels,((t,e)=>((0,l.uX)(),(0,l.CE)("div",{key:e,class:"month-label",style:(0,s.Tr)({gridColumnStart:t.columnStart})},(0,s.v_)(t.label),5)))),128))]),(0,l.Lk)("div",m,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(y.calendarCells,((t,a)=>((0,l.uX)(),(0,l.CE)("div",{key:a,class:(0,s.C4)(["calendar-cell",y.getActivityClass(t)]),style:(0,s.Tr)({gridColumn:t.column,gridRow:t.row,backgroundColor:t.date?y.getActivityColor(t,L.activeTab):"transparent"})},[t.date?((0,l.uX)(),(0,l.Wv)(T,{key:0,effect:"dark",placement:"top",content:y.formatTooltip(t)},{default:(0,l.k6)((()=>e[11]||(e[11]=[(0,l.Lk)("div",{class:"cell-content"},null,-1)]))),_:2},1032,["content"])):(0,l.Q3)("",!0)],6)))),128))]),e[12]||(e[12]=(0,l.Lk)("div",{class:"activity-legend"},[(0,l.Lk)("span",{class:"legend-label"},"活跃度："),(0,l.Lk)("ul",{class:"legend-list"},[(0,l.Lk)("li",{class:"legend-item"},[(0,l.Lk)("div",{class:"legend-box level-0"}),(0,l.Lk)("span",null,"无记录")]),(0,l.Lk)("li",{class:"legend-item"},[(0,l.Lk)("div",{class:"legend-box level-1"}),(0,l.Lk)("span",null,"1-2条")]),(0,l.Lk)("li",{class:"legend-item"},[(0,l.Lk)("div",{class:"legend-box level-2"}),(0,l.Lk)("span",null,"3-5条")]),(0,l.Lk)("li",{class:"legend-item"},[(0,l.Lk)("div",{class:"legend-box level-3"}),(0,l.Lk)("span",null,"6-9条")]),(0,l.Lk)("li",{class:"legend-item"},[(0,l.Lk)("div",{class:"legend-box level-4"}),(0,l.Lk)("span",null,"10+条")])])],-1))])])])),_:1})])])])}a(8111),a(7588);var L=a(6493),y=a(7477),D=a(1184);function C(){return(0,D.A)({url:"/api/activity/",method:"get"})}var _={name:"HomeView",components:{AppHeader:L.A,Collection:y.pMc,Document:y.yoT,Reading:y.zKN},data(){return{timeRange:"half_year",activityData:{questions:{},solutions:{},drafts:{},time_range:{start:"",end:""}},activeTab:"total",heatmapTabs:[{id:"total",label:"全部贡献"},{id:"questions",label:"题目"},{id:"solutions",label:"题解"},{id:"drafts",label:"草稿"}],colorSchemes:{total:["#ebedf0","#9be9a8","#40c463","#30a14e","#216e39"],questions:["#ebedf0","#acd5f2","#7fa8c9","#527ba0","#254e77"],solutions:["#ebedf0","#fdcfcf","#fc9494","#fa6161","#f73636"],drafts:["#ebedf0","#fff5a5","#ffec7a","#ffe352","#ffd52a"]}}},computed:{calendarCells(){if(!this.activityData.time_range||!this.activityData.time_range.start)return[];const t=[],e=new Date(this.activityData.time_range.start),a=new Date(this.activityData.time_range.end),l=new Date(e),s=l.getDay();l.setDate(l.getDate()-s);const i=Math.ceil((a-l)/864e5)+1,n=Math.ceil(i/7);let c=new Date(l);for(let o=0;o<n;o++)for(let l=0;l<7;l++){const s=this.formatDate(c),i=c>=e&&c<=a,n={questions:i&&this.activityData.questions[s]||0,solutions:i&&this.activityData.solutions[s]||0,drafts:i&&this.activityData.drafts[s]||0},r=n.questions+n.solutions+n.drafts;t.push({date:i?s:null,day:c.getDate(),column:o+1,row:l+1,activities:n,total:r}),c.setDate(c.getDate()+1)}return t},monthLabels(){if(!this.calendarCells.length)return[];const t=[];let e="";return this.calendarCells.forEach((a=>{if(a.date){const l=new Date(a.date),s=`${l.getFullYear()}-${l.getMonth()}`;if(s!==e){const i=l.toLocaleString("zh-CN",{month:"short"});t.push({label:i,columnStart:a.column}),e=s}}})),t}},watch:{timeRange(){this.fetchActivityData()}},created(){this.fetchActivityData()},methods:{async fetchActivityData(){try{const t=await C({range:this.timeRange});this.activityData=t.data}catch(t){console.error("获取活动数据失败:",t),this.activityData={questions:{},solutions:{},drafts:{},time_range:{start:(new Date).toISOString().substring(0,10),end:(new Date).toISOString().substring(0,10)}}}},formatDate(t){const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${e}-${a}-${l}`},formatLocalDate(t){if(!t)return"";const e=new Date(t);return e.toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric",weekday:"short"})},getActivityClass(t){if(!t.date)return"empty-cell";let e=0;switch(this.activeTab){case"total":e=t.total;break;case"questions":e=t.activities.questions;break;case"solutions":e=t.activities.solutions;break;case"drafts":e=t.activities.drafts;break}return 0===e?"level-0":e<=2?"level-1":e<=5?"level-2":e<=9?"level-3":"level-4"},getActivityColor(t,e){if(!t.date)return"transparent";let a=0;switch(e){case"total":a=t.total;break;case"questions":a=t.activities.questions;break;case"solutions":a=t.activities.solutions;break;case"drafts":a=t.activities.drafts;break}const l=this.colorSchemes[e];return 0===a?l[0]:a<=2?l[1]:a<=5?l[2]:a<=9?l[3]:l[4]},formatTooltip(t){if(!t.date)return"";const e=this.formatLocalDate(t.date),a=[`${e}`];return t.activities.questions>0&&a.push(`题目: ${t.activities.questions} 个`),t.activities.solutions>0&&a.push(`题解: ${t.activities.solutions} 篇`),t.activities.drafts>0&&a.push(`草稿: ${t.activities.drafts} 份`),0===t.total?a.push("无活动记录"):a.push(`总计: ${t.total} 个贡献`),a.join("\n")}}},w=a(1241);const F=(0,w.A)(_,[["render",p],["__scopeId","data-v-1649133c"]]);var q=F}}]);
//# sourceMappingURL=472.a5abcd59.js.map