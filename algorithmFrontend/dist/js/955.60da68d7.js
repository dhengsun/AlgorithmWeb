"use strict";(self["webpackChunkvue_django_frontend"]=self["webpackChunkvue_django_frontend"]||[]).push([[955],{3955:function(e,t,i){i.r(t),i.d(t,{default:function(){return W}});var s=i(6768),n=i(4232);const o={class:"question-detail-view"},l={class:"page-container"},a={key:0,class:"loading-container"},r={key:1,class:"error-container"},d={key:2,class:"question-content"},c={class:"left-section"},u=["innerHTML"],h=["innerHTML"],g={class:"right-section"},p={class:"info-meta"},m={key:0,class:"deleted-status"},f={class:"action-buttons"},k={class:"difficulty-section"},y={class:"tags-section"},b={class:"tags-container"},_={class:"dialog-footer"},q={class:"dialog-footer"};function v(e,t,i,v,L,C){const E=(0,s.g2)("AppHeader"),x=(0,s.g2)("el-skeleton"),T=(0,s.g2)("el-alert"),D=(0,s.g2)("el-card"),w=(0,s.g2)("el-tag"),F=(0,s.g2)("EditPen"),M=(0,s.g2)("el-icon"),W=(0,s.g2)("el-button"),H=(0,s.g2)("Delete"),$=(0,s.g2)("RefreshRight"),A=(0,s.g2)("Plus"),V=(0,s.g2)("el-dialog");return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.bF)(E),(0,s.Lk)("main",l,[L.loading?((0,s.uX)(),(0,s.CE)("div",a,[(0,s.bF)(x,{rows:10,animated:""})])):L.error?((0,s.uX)(),(0,s.CE)("div",r,[(0,s.bF)(T,{title:L.error,type:"error",closable:!1},null,8,["title"])])):((0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("div",c,[(0,s.bF)(D,{class:"question-description-card"},{default:(0,s.k6)((()=>["leetcode"===L.question.oj_platform?((0,s.uX)(),(0,s.CE)("div",{key:0,innerHTML:C.compiledHtml,class:"html-content"},null,8,u)):((0,s.uX)(),(0,s.CE)("div",{key:1,innerHTML:C.compiledMarkdown,class:"markdown-content"},null,8,h))])),_:1})]),(0,s.Lk)("div",g,[(0,s.bF)(D,{class:"question-info-card"},{default:(0,s.k6)((()=>[(0,s.Lk)("h2",null,(0,n.v_)(L.question.name),1),(0,s.Lk)("div",p,[(0,s.Lk)("div",null,"题目ID: "+(0,n.v_)(L.question.id),1),(0,s.Lk)("div",null,"外部ID: "+(0,n.v_)(L.question.ext_question_id),1),(0,s.Lk)("div",null,[t[4]||(t[4]=(0,s.eW)(" 平台: ")),(0,s.bF)(w,{type:C.getPlatformTagType(L.question.oj_platform),size:"small"},{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(C.getPlatformName(L.question.oj_platform)),1)])),_:1},8,["type"])]),(0,s.Lk)("div",null,"创建时间: "+(0,n.v_)(C.formatDate(L.question.created_at)),1),L.question.is_deleted?((0,s.uX)(),(0,s.CE)("div",m,[(0,s.bF)(w,{type:"danger",effect:"dark"},{default:(0,s.k6)((()=>t[5]||(t[5]=[(0,s.eW)("已删除")]))),_:1})])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",f,[(0,s.bF)(W,{type:"primary",size:"small",onClick:C.handleEdit,disabled:L.question.is_deleted},{default:(0,s.k6)((()=>[(0,s.bF)(M,null,{default:(0,s.k6)((()=>[(0,s.bF)(F)])),_:1}),t[6]||(t[6]=(0,s.eW)(" 编辑 "))])),_:1},8,["onClick","disabled"]),L.question.is_deleted?((0,s.uX)(),(0,s.Wv)(W,{key:1,type:"success",size:"small",onClick:C.handleRestore},{default:(0,s.k6)((()=>[(0,s.bF)(M,null,{default:(0,s.k6)((()=>[(0,s.bF)($)])),_:1}),t[8]||(t[8]=(0,s.eW)(" 恢复 "))])),_:1},8,["onClick"])):((0,s.uX)(),(0,s.Wv)(W,{key:0,type:"danger",size:"small",onClick:C.handleDelete},{default:(0,s.k6)((()=>[(0,s.bF)(M,null,{default:(0,s.k6)((()=>[(0,s.bF)(H)])),_:1}),t[7]||(t[7]=(0,s.eW)(" 删除 "))])),_:1},8,["onClick"])),(0,s.bF)(W,{type:"success",size:"small",onClick:C.handleCreateSolution,disabled:L.question.is_deleted},{default:(0,s.k6)((()=>[(0,s.bF)(M,null,{default:(0,s.k6)((()=>[(0,s.bF)(A)])),_:1}),t[9]||(t[9]=(0,s.eW)(" 创建题解 "))])),_:1},8,["onClick","disabled"])])])),_:1}),(0,s.bF)(D,{class:"question-tags-card"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",k,[t[10]||(t[10]=(0,s.Lk)("h3",null,"难度级别",-1)),(0,s.bF)(w,{type:C.getDifficultyTagType(L.question),effect:"dark"},{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(L.question.difficulty),1)])),_:1},8,["type"])]),(0,s.Lk)("div",y,[t[11]||(t[11]=(0,s.Lk)("h3",null,"算法标签",-1)),(0,s.Lk)("div",b,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(L.question.algorithm_tags,(e=>((0,s.uX)(),(0,s.Wv)(w,{key:e,type:C.getTagType(e,L.question.oj_platform),class:"algorithm-tag"},{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(C.getTagName(e)),1)])),_:2},1032,["type"])))),128))])])])),_:1}),(0,s.Q3)("",!0)])]))]),(0,s.bF)(V,{modelValue:L.deleteDialogVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>L.deleteDialogVisible=e),title:"确认删除",width:"30%"},{footer:(0,s.k6)((()=>[(0,s.Lk)("span",_,[(0,s.bF)(W,{onClick:t[0]||(t[0]=e=>L.deleteDialogVisible=!1)},{default:(0,s.k6)((()=>t[13]||(t[13]=[(0,s.eW)("取消")]))),_:1}),(0,s.bF)(W,{type:"danger",onClick:C.confirmDelete,loading:L.processing},{default:(0,s.k6)((()=>t[14]||(t[14]=[(0,s.eW)("确认删除")]))),_:1},8,["onClick","loading"])])])),default:(0,s.k6)((()=>[(0,s.Lk)("span",null,'确定要删除题目 "'+(0,n.v_)(L.question?L.question.name:"")+'" 吗？此操作不可逆。',1)])),_:1},8,["modelValue"]),(0,s.bF)(V,{modelValue:L.restoreDialogVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>L.restoreDialogVisible=e),title:"确认恢复",width:"30%"},{footer:(0,s.k6)((()=>[(0,s.Lk)("span",q,[(0,s.bF)(W,{onClick:t[2]||(t[2]=e=>L.restoreDialogVisible=!1)},{default:(0,s.k6)((()=>t[15]||(t[15]=[(0,s.eW)("取消")]))),_:1}),(0,s.bF)(W,{type:"success",onClick:C.confirmRestore,loading:L.processing},{default:(0,s.k6)((()=>t[16]||(t[16]=[(0,s.eW)("确认恢复")]))),_:1},8,["onClick","loading"])])])),default:(0,s.k6)((()=>[(0,s.Lk)("span",null,'确定要恢复题目 "'+(0,n.v_)(L.question?L.question.name:"")+'" 吗？',1)])),_:1},8,["modelValue"])])}i(4114),i(8111),i(2489),i(7588),i(1701);var L=i(6493),C=i(2846),E=i(642),x=i(8353),T=i(7477),D=i(1219),w={name:"QuestionDetailView",components:{AppHeader:L.A,EditPen:T.EDh,Delete:T.epd,Plus:T.FWt,RefreshRight:T.kyK},data(){return{questionId:this.$route.params.id,question:null,loading:!0,error:null,mdi:new E.A({html:!0,linkify:!0,typographer:!0}),mathJaxLoaded:!1,deleteDialogVisible:!1,restoreDialogVisible:!1,processing:!1}},computed:{compiledMarkdown(){if(!this.question||!this.question.content)return"";try{const e=String(this.question.content||""),t=this.mdi.render(e);return x.A.sanitize(t)}catch(e){return console.error("Markdown处理错误:",e),"内容解析出错"}},compiledHtml(){if(!this.question||!this.question.content)return"";try{let e=String(this.question.content||"");return e.trim().startsWith("<")||(e=`<div>${e}</div>`),e=this.processLeetcodeHtml(e),e=this.wrapExamples(e),x.A.sanitize(e,{USE_PROFILES:{html:!0},ALLOWED_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","ol","ul","li","pre","code","blockquote","table","thead","tbody","tr","th","td","strong","em","b","i","u","strike","s","a","img","span","div","section","article","meta"],ALLOWED_ATTR:["href","name","target","src","alt","class","id","width","height","style","charset","content"]})}catch(e){return console.error("HTML处理错误:",e),"内容解析出错"}}},watch:{question:{handler(){this.$nextTick((()=>this.renderMathJax()))},deep:!0}},mounted(){this.fetchQuestionDetail(),this.initMathJax()},methods:{handleEdit(){this.question&&!this.question.is_deleted&&this.$router.push(`/questions/update/${this.question.id}`)},handleDelete(){this.question&&!this.question.is_deleted&&(this.deleteDialogVisible=!0)},handleRestore(){this.question&&this.question.is_deleted&&(this.restoreDialogVisible=!0)},async confirmDelete(){if(this.question){this.processing=!0;try{await(0,C.ul)({id:this.question.id}),(0,D.nk)({type:"success",message:"题目删除成功"}),this.deleteDialogVisible=!1,this.fetchQuestionDetail()}catch(e){console.error("删除题目失败:",e),(0,D.nk)({type:"error",message:"删除题目失败: "+(e.message||"未知错误")})}finally{this.processing=!1}}},async confirmRestore(){if(this.question){this.processing=!0;try{await(0,C.l)({id:this.question.id}),(0,D.nk)({type:"success",message:"题目恢复成功"}),this.restoreDialogVisible=!1,this.fetchQuestionDetail()}catch(e){console.error("恢复题目失败:",e),(0,D.nk)({type:"error",message:"恢复题目失败: "+(e.message||"未知错误")})}finally{this.processing=!1}}},handleCreateSolution(){this.question&&!this.question.is_deleted&&this.$router.push(`/create/solution?question_id=${this.question.id}`)},processLeetcodeHtml(e){try{(e.includes("\\n")||e.includes("&lt;")||e.includes("&gt;"))&&(e=this.convertLeetcodeEscapedContent(e));const t=document.createElement("div");t.innerHTML=e;const i=t.querySelectorAll("pre");i.forEach((e=>{e.classList.add("leetcode-code-block");const t=e.querySelector("code");t&&(t.className.includes("language-")||t.classList.add("language-plain"))}));const s=t.querySelectorAll("table");s.forEach((e=>{const t=document.createElement("div");t.className="table-responsive",e.parentNode.insertBefore(t,e),t.appendChild(e)}));const n=t.querySelectorAll("*:not(strong):not(b)");n.forEach((e=>{const t=e.innerHTML;t&&"string"===typeof t&&t.includes("**")&&(e.innerHTML=t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"))}));const o=document.createElement("meta");return o.setAttribute("name","rendering-mode"),o.setAttribute("content","leetcode-html"),t.insertBefore(o,t.firstChild),t.innerHTML}catch(t){return console.error("处理LeetCode HTML时出错:",t),e}},convertLeetcodeEscapedContent(e){return e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'"),e=e.replace(/\\n/g,"<br>"),e=e.replace(/\\t/g,"&emsp;&emsp;"),e=e.replace(/(<br>){2,}/g,"</p><p>").replace(/<br>/g,"<br>\n"),e=e.replace(/示例 (\d+):/g,"<h3>示例 $1</h3>").replace(/输入: /g,"<strong>输入</strong>: ").replace(/输出: /g,"<strong>输出</strong>: ").replace(/解释: /g,"<strong>解释</strong>: "),e=e.replace(/提示:|注意:/g,"<h3>$&</h3>"),e.startsWith("<")&&["<p","<div","<h"].includes(e.substring(0,2))||(e="<p>"+e+"</p>"),e},wrapExamples(e){try{const t=document.createElement("div");t.innerHTML=e;const i=t.querySelectorAll("h3");return i.forEach((e=>{if(e.textContent.includes("示例")){let i=[],s=e.nextElementSibling;while(s&&"H3"!==s.tagName&&!s.textContent.includes("提示")&&!s.textContent.includes("注意"))i.push(s.cloneNode(!0)),s=s.nextElementSibling;const n=document.createElement("div");n.className="example-block",n.appendChild(e.cloneNode(!0)),i.forEach((e=>{n.appendChild(e)})),e.parentNode.insertBefore(n,e),e.remove(),i.forEach((e=>{const i=t.querySelector(`*:nth-child(${Array.from(t.children).indexOf(e)+1})`);i&&i.remove()}))}})),t.innerHTML}catch(t){return console.error("包装示例部分时出错:",t),e}},renderMathJax(){"undefined"!==typeof MathJax&&MathJax.typesetPromise&&this.mathJaxLoaded&&MathJax.typesetPromise()},initMathJax(){if(this.mathJaxLoaded||"undefined"!==typeof MathJax)return void(this.mathJaxLoaded=!0);window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]},startup:{ready:()=>{MathJax.startup.defaultReady(),this.mathJaxLoaded=!0,this.$nextTick((()=>this.renderMathJax()))}}};const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js",e.async=!0,e.onload=()=>{this.mathJaxLoaded=!0},document.head.appendChild(e)},async fetchQuestionDetail(){this.loading=!0,this.error=null;try{const e=await(0,C.so)(this.questionId);this.question=e.data,"string"===typeof this.question.algorithm_tags&&(this.question.algorithm_tags=this.question.algorithm_tags.split(",").map((e=>e.trim())).filter((e=>e.length>0)))}catch(e){console.error("获取题目详情失败:",e),this.error="获取题目详情失败: "+(e.message||"未知错误")}finally{this.loading=!1}},getPlatformName(e){const t={luogu:"洛谷",leetcode:"LeetCode"};return t[e]||e},getPlatformTagType(e){return{luogu:"success",leetcode:"warning"}[e]||"info"},formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},getDifficultyTagType(e){if("luogu"===e.oj_platform){const t={"入门":"info","普及-":"success","普及/提高-":"success","普及+/提高":"warning","提高+/省选-":"danger","省选/NOI-":"danger","NOI/NOI+":"danger",CTSC:"danger"};return t[e.difficulty]||"info"}return{"简单":"success","中等":"warning","困难":"danger"}[e.difficulty]||"info"},getTagType(e,t){if("leetcode"===t)return"primary";const i=e.split("_")[0];return{Algorithm:"primary",Source:"success",Time:"warning",Region:"danger",Other:"info"}[i]||"info"},getTagName(e){const t=e.split("_");return t.length>1?t.slice(1).join("_"):e},generateOjLink(e){const t={luogu:`https://www.luogu.com.cn/problem/${e.ext_question_id}`,leetcode:`https://leetcode.cn/problems/${e.ext_question_id}/`};return t[e.oj_platform]||"#"}}},F=i(1241);const M=(0,F.A)(w,[["render",v],["__scopeId","data-v-4373e632"]]);var W=M}}]);
//# sourceMappingURL=955.60da68d7.js.map