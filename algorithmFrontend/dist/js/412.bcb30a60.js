"use strict";(self["webpackChunkvue_django_frontend"]=self["webpackChunkvue_django_frontend"]||[]).push([[412],{2196:function(e,t,l){l.d(t,{PU:function(){return r},dv:function(){return o},ur:function(){return a}});l(4114),l(8111),l(7588);const o=["Shell","二分查找","二叉搜索树","二叉树","交互","位运算","分治","前缀和","单向链表","单调栈","单调队列","双向链表","双指针","双连通分量","后缀数组","哈希函数","哈希表","图","基数排序","堆（优先队列）","字典树","字符串","字符串匹配","归并排序","快速选择","扫描线","拒绝采样","拓扑排序","排序","数论","数学","数据库","数据流","数组","最小生成树","最短路","有序集合","栈","树","树状数组","欧拉回路","概率与统计","模拟","滑动窗口","滚动哈希","深度优先搜索","状态压缩","矩阵","线段树","组合数学","脑筋急转弯","计数","计数排序","设计","贪心","迭代器","递归","链表","队列","随机化","集合","几何","动态规划","博弈","并查集","广度优先搜索","强连通分量","桶排序","水塘抽样","记忆化搜索","回溯","多线程","枚举"],a=["入门","普及-","普及/提高-","普及+/提高","提高+/省选-","省选/NOI-","NOI/NOI+","CTSC"],r=["简单","中等","困难"]},3412:function(e,t,l){l.r(t),l.d(t,{default:function(){return C}});var o=l(6768),a=l(4232);const r={class:"question-update-view"},i={class:"page-container"},s={key:0,class:"id-query-section"},n={key:1,class:"loading-container"},u={key:2,class:"error-container"},d={key:3,class:"question-form-container"},m={class:"tags-container"},g=["innerHTML"],h=["innerHTML"];function c(e,t,l,c,f,F){const b=(0,o.g2)("AppHeader"),p=(0,o.g2)("el-input"),_=(0,o.g2)("el-form-item"),q=(0,o.g2)("el-button"),y=(0,o.g2)("el-form"),k=(0,o.g2)("el-skeleton"),v=(0,o.g2)("el-alert"),C=(0,o.g2)("el-divider"),T=(0,o.g2)("el-col"),w=(0,o.g2)("el-row"),V=(0,o.g2)("el-option"),S=(0,o.g2)("el-select"),j=(0,o.g2)("el-tag"),I=(0,o.g2)("el-option-group"),A=(0,o.g2)("el-tab-pane"),L=(0,o.g2)("el-tabs"),E=(0,o.g2)("el-card");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(b),(0,o.Lk)("main",i,[(0,o.bF)(E,{class:"update-card"},{header:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.Lk)("div",{class:"card-header"},[(0,o.Lk)("h2",null,"更新题目")],-1)]))),default:(0,o.k6)((()=>[f.question?f.loading?((0,o.uX)(),(0,o.CE)("div",n,[(0,o.bF)(k,{rows:10,animated:""})])):f.error?((0,o.uX)(),(0,o.CE)("div",u,[(0,o.bF)(v,{title:f.error,type:"error",closable:!1,onClose:F.resetQuery},null,8,["title","onClose"]),(0,o.bF)(q,{class:"mt-3",onClick:F.resetQuery},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)("返回")]))),_:1},8,["onClick"])])):((0,o.uX)(),(0,o.CE)("div",d,[(0,o.bF)(y,{model:f.questionForm,rules:f.rules,ref:"formRef","label-width":"100px","label-position":"top"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{"content-position":"left"},{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.eW)("基本信息")]))),_:1}),(0,o.bF)(w,{gutter:20},{default:(0,o.k6)((()=>[(0,o.bF)(T,{span:12},{default:(0,o.k6)((()=>[(0,o.bF)(_,{label:"题目名称",prop:"name"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:f.questionForm.name,"onUpdate:modelValue":t[1]||(t[1]=e=>f.questionForm.name=e),placeholder:"请输入题目名称"},null,8,["modelValue"])])),_:1})])),_:1}),(0,o.bF)(T,{span:12},{default:(0,o.k6)((()=>[(0,o.bF)(_,{label:"外部ID",prop:"ext_question_id"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:f.questionForm.ext_question_id,"onUpdate:modelValue":t[2]||(t[2]=e=>f.questionForm.ext_question_id=e),placeholder:"请输入外部ID"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,o.bF)(w,{gutter:20},{default:(0,o.k6)((()=>[(0,o.bF)(T,{span:12},{default:(0,o.k6)((()=>[(0,o.bF)(_,{label:"平台",prop:"oj_platform"},{default:(0,o.k6)((()=>[(0,o.bF)(S,{modelValue:f.questionForm.oj_platform,"onUpdate:modelValue":t[3]||(t[3]=e=>f.questionForm.oj_platform=e),placeholder:"请选择平台",style:{width:"100%"},onChange:F.handlePlatformChange},{default:(0,o.k6)((()=>[(0,o.bF)(V,{label:"LeetCode",value:"leetcode"}),(0,o.bF)(V,{label:"洛谷",value:"luogu"})])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1}),(0,o.bF)(T,{span:12},{default:(0,o.k6)((()=>[(0,o.bF)(_,{label:"难度",prop:"difficulty"},{default:(0,o.k6)((()=>[(0,o.bF)(S,{modelValue:f.questionForm.difficulty,"onUpdate:modelValue":t[4]||(t[4]=e=>f.questionForm.difficulty=e),placeholder:"请选择难度",style:{width:"100%"}},{default:(0,o.k6)((()=>["leetcode"===f.questionForm.oj_platform?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.bF)(V,{label:"简单",value:"简单"}),(0,o.bF)(V,{label:"中等",value:"中等"}),(0,o.bF)(V,{label:"困难",value:"困难"})],64)):"luogu"===f.questionForm.oj_platform?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.bF)(V,{label:"入门",value:"入门"}),(0,o.bF)(V,{label:"普及-",value:"普及-"}),(0,o.bF)(V,{label:"普及/提高-",value:"普及/提高-"}),(0,o.bF)(V,{label:"普及+/提高",value:"普及+/提高"}),(0,o.bF)(V,{label:"提高+/省选-",value:"提高+/省选-"}),(0,o.bF)(V,{label:"省选/NOI-",value:"省选/NOI-"}),(0,o.bF)(V,{label:"NOI/NOI+",value:"NOI/NOI+"}),(0,o.bF)(V,{label:"CTSC",value:"CTSC"})],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:2},[(0,o.bF)(V,{label:"简单",value:"简单"}),(0,o.bF)(V,{label:"中等",value:"中等"}),(0,o.bF)(V,{label:"困难",value:"困难"})],64))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,o.bF)(C,{"content-position":"left"},{default:(0,o.k6)((()=>t[12]||(t[12]=[(0,o.eW)("算法标签")]))),_:1}),(0,o.bF)(_,{label:"已选标签",prop:"algorithm_tags"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",m,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(f.questionForm.algorithm_tags,(e=>((0,o.uX)(),(0,o.Wv)(j,{key:e,closable:"",type:F.getTagType(e,f.questionForm.oj_platform),onClose:t=>F.handleTagClose(e),class:"algorithm-tag"},{default:(0,o.k6)((()=>[(0,o.eW)((0,a.v_)(F.getTagName(e)),1)])),_:2},1032,["type","onClose"])))),128))])])),_:1}),(0,o.bF)(_,{label:"添加标签"},{default:(0,o.k6)((()=>[(0,o.bF)(S,{modelValue:f.tagSearchValue,"onUpdate:modelValue":t[5]||(t[5]=e=>f.tagSearchValue=e),filterable:"",remote:"","reserve-keyword":"",placeholder:"输入关键词搜索标签","remote-method":F.searchTags,loading:f.tagSearchLoading,onChange:F.handleTagSelect,class:"tag-select",clearable:""},{default:(0,o.k6)((()=>["luogu"===f.questionForm.oj_platform&&f.tagCategoryTitle?((0,o.uX)(),(0,o.Wv)(I,{key:0,label:f.tagCategoryTitle},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(f.filteredTags,(e=>((0,o.uX)(),(0,o.Wv)(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["label"])):((0,o.uX)(!0),(0,o.CE)(o.FK,{key:1},(0,o.pI)(f.filteredTags,(e=>((0,o.uX)(),(0,o.Wv)(V,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","remote-method","loading","onChange"])])),_:1}),(0,o.bF)(C,{"content-position":"left"},{default:(0,o.k6)((()=>t[13]||(t[13]=[(0,o.eW)("题目内容")]))),_:1}),(0,o.bF)(_,{label:"题目内容",prop:"content",rules:[{required:!0,message:"题目内容不能为空",trigger:"blur"}]},{default:(0,o.k6)((()=>[(0,o.bF)(L,{modelValue:f.contentTabActive,"onUpdate:modelValue":t[7]||(t[7]=e=>f.contentTabActive=e)},{default:(0,o.k6)((()=>[(0,o.bF)(A,{label:"编辑",name:"edit"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:f.questionForm.content,"onUpdate:modelValue":t[6]||(t[6]=e=>f.questionForm.content=e),type:"textarea",rows:15,placeholder:"请输入题目内容"},null,8,["modelValue"])])),_:1}),(0,o.bF)(A,{label:"预览",name:"preview"},{default:(0,o.k6)((()=>["leetcode"===f.questionForm.oj_platform?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"preview-container html-content",innerHTML:F.previewHtml},null,8,g)):((0,o.uX)(),(0,o.CE)("div",{key:1,class:"preview-container markdown-content",innerHTML:F.previewMarkdown},null,8,h))])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,o.bF)(_,null,{default:(0,o.k6)((()=>[(0,o.bF)(q,{type:"primary",onClick:F.submitForm},{default:(0,o.k6)((()=>t[14]||(t[14]=[(0,o.eW)("更新题目")]))),_:1},8,["onClick"]),(0,o.bF)(q,{onClick:F.resetForm},{default:(0,o.k6)((()=>t[15]||(t[15]=[(0,o.eW)("重置表单")]))),_:1},8,["onClick"]),(0,o.bF)(q,{type:"info",onClick:F.resetQuery},{default:(0,o.k6)((()=>t[16]||(t[16]=[(0,o.eW)("返回查询")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])):((0,o.uX)(),(0,o.CE)("div",s,[(0,o.bF)(y,{model:f.queryForm,rules:f.queryRules,ref:"queryFormRef","label-width":"80px"},{default:(0,o.k6)((()=>[(0,o.bF)(_,{label:"题目ID",prop:"id"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{modelValue:f.queryForm.id,"onUpdate:modelValue":t[0]||(t[0]=e=>f.queryForm.id=e),placeholder:"请输入题目ID（如E1、E2等）"},null,8,["modelValue"])])),_:1}),(0,o.bF)(_,null,{default:(0,o.k6)((()=>[(0,o.bF)(q,{type:"primary",onClick:F.fetchQuestion},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)("查询题目")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])]))])),_:1})])])}l(4114),l(8111),l(2489),l(1701),l(3579);var f=l(6493),F=l(2846),b=l(642),p=l(8353),_=l(1219),q=l(2196),y={name:"QuestionUpdate",components:{AppHeader:f.A},data(){return{queryForm:{id:""},queryRules:{id:[{required:!0,message:"请输入题目ID",trigger:"blur"},{pattern:/^[a-zA-Z0-9]+$/,message:"题目ID只能包含字母和数字",trigger:"blur"}]},question:null,loading:!1,error:null,questionForm:{id:"",name:"",ext_question_id:"",oj_platform:"",difficulty:"",algorithm_tags:[],content:""},rules:{name:[{required:!0,message:"请输入题目名称",trigger:"blur"},{min:1,max:100,message:"长度在1到100个字符",trigger:"blur"}],ext_question_id:[{required:!0,message:"请输入外部ID",trigger:"blur"}],oj_platform:[{required:!0,message:"请选择平台",trigger:"change"}],difficulty:[{required:!0,message:"请选择难度",trigger:"change"}]},tagInputVisible:!1,tagInputValue:"",tagSearchValue:"",tagSearchLoading:!1,tagCategoryTitle:"",allTags:{leetcode:q.dv.map((e=>({label:e,value:e}))),luogu:{Algorithm:[],Source:[],Time:[],Region:[],Other:[]}},filteredTags:[],contentTabActive:"edit",mdi:new b.A({html:!0,linkify:!0,typographer:!0})}},computed:{previewMarkdown(){if(!this.questionForm.content)return"";try{const e=String(this.questionForm.content||""),t=this.mdi.render(e);return p.A.sanitize(t)}catch(e){return console.error("Markdown处理错误:",e),"内容解析出错"}},previewHtml(){if(!this.questionForm.content)return"";try{let e=String(this.questionForm.content||"");return p.A.sanitize(e,{USE_PROFILES:{html:!0},ALLOWED_TAGS:["h1","h2","h3","h4","h5","h6","p","br","hr","ol","ul","li","pre","code","blockquote","table","thead","tbody","tr","th","td","strong","em","b","i","u","strike","s","a","img","span","div","section","article"]})}catch(e){return console.error("HTML处理错误:",e),"内容解析出错"}}},mounted(){this.loadAllTags();const e=this.$route.params.id;e&&(this.queryForm.id=e,this.fetchQuestion())},methods:{async loadAllTags(){try{const e=await(0,F.r)();e.data&&200===e.data.code&&(this.allTags.luogu=e.data.data)}catch(e){console.error("加载标签失败:",e),_.nk.error("加载标签数据失败")}},handlePlatformChange(){this.tagSearchValue="",this.filteredTags=[],confirm("切换平台将清空已选标签，是否继续？")?this.questionForm.algorithm_tags=[]:this.questionForm.oj_platform=this.question.oj_platform},searchTags(e){if(this.tagSearchLoading=!0,this.tagCategoryTitle="",""===e.trim())return this.filteredTags=[],void(this.tagSearchLoading=!1);setTimeout((()=>{if("leetcode"===this.questionForm.oj_platform)this.filteredTags=this.allTags.leetcode.filter((t=>t.label.toLowerCase().includes(e.toLowerCase())));else if("luogu"===this.questionForm.oj_platform){let t=[];for(const l in this.allTags.luogu){const o=this.allTags.luogu[l].filter((t=>t.name.toLowerCase().includes(e.toLowerCase()))).map((e=>({label:e.name,value:`${l}_${e.name}`,category:l})));o.length&&(this.tagCategoryTitle=this.getCategoryName(l),t=[...t,...o])}this.filteredTags=t}this.tagSearchLoading=!1}),200)},getCategoryName(e){const t={Algorithm:"算法标签",Source:"来源标签",Time:"时间标签",Region:"地区标签",Other:"其他标签"};return t[e]||e},handleTagSelect(e){e&&(this.questionForm.algorithm_tags.includes(e)?_.nk.warning("该标签已添加"):(this.questionForm.algorithm_tags.push(e),_.nk.success("标签添加成功")),this.tagSearchValue="")},async fetchQuestion(){try{await this.$refs.queryFormRef.validate()}catch(e){return!1}this.loading=!0,this.error=null;try{const e=await(0,F.so)(this.queryForm.id);this.question=e.data,this.fillFormWithQuestion(this.question),this.loading=!1}catch(e){console.error("获取题目详情失败:",e),this.error="获取题目详情失败: "+(e.message||"未知错误"),this.loading=!1}},fillFormWithQuestion(e){this.questionForm.id=e.id,this.questionForm.name=e.name,this.questionForm.ext_question_id=e.ext_question_id,this.questionForm.oj_platform=e.oj_platform,this.questionForm.difficulty=e.difficulty,this.questionForm.content=e.content,"string"===typeof e.algorithm_tags?this.questionForm.algorithm_tags=e.algorithm_tags.split(",").map((e=>e.trim())).filter((e=>e.length>0)):Array.isArray(e.algorithm_tags)?this.questionForm.algorithm_tags=[...e.algorithm_tags]:this.questionForm.algorithm_tags=[]},resetQuery(){this.question=null,this.error=null,this.queryForm.id="",this.$refs.queryFormRef&&this.$refs.queryFormRef.resetFields()},resetForm(){this.$refs.formRef&&this.$refs.formRef.resetFields(),this.question&&this.fillFormWithQuestion(this.question)},async submitForm(){try{await this.$refs.formRef.validate()}catch(e){return!1}this.loading=!0;try{const e={id:this.questionForm.id,name:this.questionForm.name,ext_question_id:this.questionForm.ext_question_id,oj_platform:this.questionForm.oj_platform,difficulty:this.questionForm.difficulty,content:this.questionForm.content,algorithm_tags:Array.isArray(this.questionForm.algorithm_tags)?[...this.questionForm.algorithm_tags]:[]};"leetcode"===this.questionForm.oj_platform?e.url=`https://leetcode.cn/problems/${this.questionForm.ext_question_id}/`:"luogu"===this.questionForm.oj_platform&&(e.url=`https://www.luogu.com.cn/problem/${this.questionForm.ext_question_id}`),console.log("发送更新请求数据:",e),await(0,F.sr)(e.id,e),(0,_.nk)({message:"题目更新成功",type:"success"}),this.fetchQuestion()}catch(e){console.error("更新题目失败:",e),(0,_.nk)({message:"更新题目失败: "+(e.message||"未知错误"),type:"error"})}finally{this.loading=!1}},handleTagClose(e){this.questionForm.algorithm_tags=this.questionForm.algorithm_tags.filter((t=>t!==e))},getTagName(e){if(this.allTags.leetcode.some((t=>t.value===e)))return e;const t=e.split("_");return t.length>1?t.slice(1).join("_"):e},getTagType(e,t){if("leetcode"===t)return"primary";const l=e.split("_")[0];return{Algorithm:"primary",Source:"success",Time:"warning",Region:"danger",Other:"info"}[l]||"info"}}},k=l(1241);const v=(0,k.A)(y,[["render",c],["__scopeId","data-v-ba7c0e66"]]);var C=v}}]);
//# sourceMappingURL=412.bcb30a60.js.map