"use strict";(self["webpackChunkvue_django_frontend"]=self["webpackChunkvue_django_frontend"]||[]).push([[367],{9367:function(e,o,r){r.r(o),r.d(o,{default:function(){return b}});var l=r(6768),s=r(4232);const a={class:"login-container"},n={class:"login-box"},t={class:"login-header"},i={key:0,class:"subtitle"},u={key:1,class:"subtitle"},d={class:"register-link"};function g(e,o,r,g,c,m){const f=(0,l.g2)("el-icon-user"),p=(0,l.g2)("el-icon"),k=(0,l.g2)("el-input"),h=(0,l.g2)("el-form-item"),F=(0,l.g2)("el-icon-lock"),b=(0,l.g2)("el-button"),_=(0,l.g2)("el-form");return(0,l.uX)(),(0,l.CE)("div",a,[(0,l.Lk)("div",n,[(0,l.Lk)("div",t,[o[3]||(o[3]=(0,l.Lk)("h2",null,"登录",-1)),c.loginForm.username?((0,l.uX)(),(0,l.CE)("p",i,"欢迎 "+(0,s.v_)(c.loginForm.username),1)):((0,l.uX)(),(0,l.CE)("p",u,"请输入您的用户名和密码"))]),(0,l.bF)(_,{model:c.loginForm,ref:"loginFormRef",rules:c.rules,class:"login-form"},{default:(0,l.k6)((()=>[(0,l.bF)(h,{prop:"username"},{default:(0,l.k6)((()=>[(0,l.bF)(k,{modelValue:c.loginForm.username,"onUpdate:modelValue":o[0]||(o[0]=e=>c.loginForm.username=e),placeholder:"用户名",size:"large"},{prefix:(0,l.k6)((()=>[(0,l.bF)(p,{class:"input-icon"},{default:(0,l.k6)((()=>[(0,l.bF)(f)])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(h,{prop:"password"},{default:(0,l.k6)((()=>[(0,l.bF)(k,{modelValue:c.loginForm.password,"onUpdate:modelValue":o[1]||(o[1]=e=>c.loginForm.password=e),type:"password",placeholder:"密码",size:"large","show-password":""},{prefix:(0,l.k6)((()=>[(0,l.bF)(p,{class:"input-icon"},{default:(0,l.k6)((()=>[(0,l.bF)(F)])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,{type:"primary",loading:c.loading,size:"large",class:"login-button",onClick:m.handleLogin},{default:(0,l.k6)((()=>o[4]||(o[4]=[(0,l.eW)(" 登录 ")]))),_:1},8,["loading","onClick"])])),_:1})])),_:1},8,["model","rules"]),(0,l.Lk)("div",d,[(0,l.Lk)("a",{href:"javascript:void(0)",onClick:o[2]||(o[2]=(...e)=>m.goToRegister&&m.goToRegister(...e))},"马上注册")])])])}r(4114);var c=r(1219),m=r(7477),f=r(1184);function p(e){return(0,f.A)({url:"/auth/login/",method:"post",data:e})}var k={name:"LoginView",components:{ElIconUser:m.KJW,ElIconLock:m.c_I},data(){return{loginForm:{username:"",password:""},loading:!1,rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},created(){console.log("LoginView组件已创建")},methods:{async handleLogin(){if(this.$refs.loginFormRef)try{await this.$refs.loginFormRef.validate(),this.loading=!0;const e=await p(this.loginForm);console.log("登录响应:",e.data),localStorage.setItem("access_token",e.data.access),localStorage.setItem("refresh_token",e.data.refresh),localStorage.setItem("user_info",JSON.stringify(e.data.user)),c.nk.success("登录成功"),this.$router.push("/")}catch(e){console.error("登录错误:",e),c.nk.error(e.response?.data?.detail||"登录失败")}finally{this.loading=!1}},goToRegister(){this.$router.push("/register")}}},h=r(1241);const F=(0,h.A)(k,[["render",g],["__scopeId","data-v-6e0cb3cf"]]);var b=F}}]);
//# sourceMappingURL=367.4cc7ce47.js.map